DROP DATABASE IF EXISTS VOTERDB;
CREATE DATABASE VOTERDB;
USE VOTERDB;
CREATE TABLE EVS_TBL_EO(ELECTORALOFFICERID VARCHAR(6) PRIMARY KEY, CONSTITUENCY VARCHAR(25) NOT NULL);

CREATE TABLE EVS_TBL_USER_CREDENTIALS(USERID VARCHAR(6) PRIMARY KEY, PASSWORD VARCHAR(20) NOT NULL, USERTYPE VARCHAR(1) CHECK (USERTYPE='A' OR USERTYPE='E' OR USERTYPE='V'), LOGINSTATUS INT(1) CHECK (LOGINSTATUS='1' OR LOGINSTATUS='0'));

CREATE TABLE EVS_TBL_APPLICATION(USERID VARCHAR(6), FOREIGN KEY (USERID) REFERENCES EVS_TBL_USER_CREDENTIALS(USERID), CONSTITUENCY VARCHAR(20) NOT NULL, PASSEDSTATUS INT(2) CHECK (PASSEDSTATUS='1' OR PASSEDSTATUS='2' OR PASSEDSTATUS='3'), APPROVEDSTATUS INT(2) CHECK(APPROVEDSTATUS='0' OR APPROVEDSTATUS='1'), VOTERID VARCHAR(8));

CREATE TABLE EVS_TBL_USER_PROFILE(USERID VARCHAR(6), FOREIGN KEY (USERID) REFERENCES EVS_TBL_USER_CREDENTIALS(USERID), FIRSTNAME VARCHAR(15) NOT NULL, LASTNAME VARCHAR(15) NOT NULL, DATEOFBIRTH DATE NOT NULL, GENDER VARCHAR(7) NOT NULL , STREET VARCHAR(30) NOT NULL , `LOCATION` VARCHAR(15) NOT NULL , CITY VARCHAR(15) NOT NULL , `STATE` VARCHAR(15) NOT NULL, PINCODE VARCHAR(10) NOT NULL, MOBILENO VARCHAR(10) CHECK(MOBILENO BETWEEN 1000000000 AND 9999999999), EMAILID VARCHAR(30));

CREATE TABLE EVS_TBL_PARTY(PARTYID VARCHAR(6) PRIMARY KEY, `NAME` VARCHAR(20) NOT NULL, LEADER VARCHAR(20) NOT NULL, SYMBOL VARCHAR(40));

CREATE TABLE EVS_TBL_ELECTION(ELECTIONID VARCHAR(6) PRIMARY KEY, `NAME` VARCHAR(15) NOT NULL, ELECTIONDATE DATE NOT NULL, DISTRICT VARCHAR(20) NOT NULL, CONSTITUENCY VARCHAR(15) NOT NULL, COUNTINGDATE DATE NOT NULL );

CREATE TABLE EVS_TBL_CANDIDATE(CANDIDATEID VARCHAR(6) PRIMARY KEY, `NAME` VARCHAR(20) NOT NULL, ELECTIONID VARCHAR(6), FOREIGN KEY(ELECTIONID) REFERENCES EVS_TBL_ELECTION(ELECTIONID), PARTYID VARCHAR(6), FOREIGN KEY(PARTYID) REFERENCES EVS_TBL_PARTY(PARTYID), DISTRICT VARCHAR(20) NOT NULL, CONSTITUENCY VARCHAR(2) NOT NULL, DATEOFBIRTH DATE NOT NULL, MOBILENO VARCHAR(10) CHECK(MOBILENO BETWEEN 1000000000 AND 9999999999), `ADDRESS` VARCHAR(50) NOT NULL, EMAILID VARCHAR(20));

CREATE TABLE EVS_TBL_VOTER_DETAILS(SERIALNO INT(6) PRIMARY KEY AUTO_INCREMENT, CANDIDATEID VARCHAR(6), FOREIGN KEY(CANDIDATEID) REFERENCES EVS_TBL_CANDIDATE(CANDIDATEID), ELECTIONID VARCHAR(6), FOREIGN KEY(ELECTIONID) REFERENCES EVS_TBL_ELECTION(ELECTIONID), VOTERID VARCHAR(8));

ALTER TABLE EVS_TBL_VOTER_DETAILS AUTO_INCREMENT=1;

CREATE TABLE EVS_TBL_RESULT(SERIALNO INT(6) PRIMARY KEY AUTO_INCREMENT,ELECTIONID VARCHAR(6), FOREIGN KEY (ELECTIONID) REFERENCES EVS_TBL_ELECTION(ELECTIONID), CANDIDATEID VARCHAR(6), FOREIGN KEY (CANDIDATEID) REFERENCES EVS_TBL_CANDIDATE(CANDIDATEID), VOTECOUNT INT(5) NOT NULL);

ALTER TABLE EVS_TBL_RESULT AUTO_INCREMENT=1000;